import 'dart:async';
import 'dart:math';

import 'models/models.dart';
import 'restaurants_repository.dart';

class FakeRestaurantsRepository implements RestaurantsRepository {
  final _listeners = <MultiStreamController<List<Restaurant>>>[];

  final List<Restaurant> _restaurants = [];

  final rand = Random();

  @override
  Stream<Restaurant> restaurant(String id) async* {
    if (_restaurants.where((restaurant) => restaurant.id == id).isEmpty) {
      await create(Restaurant(
        id: id,
        displayName: _randName,
        address: Address(
          name: _randAddress,
          latitude: 31.2431906939,
          longitude: 34.7931751606,
        ),
        phoneNumber: '+97212345${1000 + rand.nextInt(8999)}',
        about:
            '×‘×™×Ÿ 40â‚ª-60â‚ª.â€ğŸ”¹×”××—×™×¨ ×œ×¤×™ ×§×´×’. ×œ× ×—×™×™×‘ ×œ×§× ×•×ª ×§×´×’ğŸ”¹â€××•×–×× ×™× ×œ××¡×¢×“×ª ×¤××˜×™×• ×‘×›×œ ×™×•× ×‘×™×Ÿ ×”×©×¢×•×ª 10:00-14:00. ×•×‘×›×œ ×™×•× ×©×™×©×™ ×œ××›×™×¨×ª ×”××•×›×œ ×©×œ× ×• ×‘× ×§×•×“×•×ª ×”××›×™×¨×”: â€ğŸ”¸×§× ×™×•×Ÿ â€×“×¨×š â€×”×™×, â€×¢×ª×œ×™×ª.â€ğŸ”¸××¡×¢×“×ª â€×¤××˜×™×• â€(××ª×’×¨ â€5, â€×˜×™×¨×ª â€×›×¨××œ)08:00-14:00 ×œ×¤×¨×˜×™×/×”×–×× ×•×ª/×¡×’×™×¨×ª ×ª××¨×™×š ×œ×§×™×™×˜×¨×™× ×’/××©×œ×•×—×™×â€ğŸ“ â€â€',
        photoURL:
            'https://firebasestorage.googleapis.com/v0/b/cookpoint-e16ce.appspot.com/o/logo.png?alt=media&token=7566ed32-d1d1-47ec-ae2c-3d805f38f935',
      ));
    }

    yield* stream().map((restaurants) {
      return restaurants.where((restaurants) => restaurants.id == id).first;
    });
  }

  @override
  Future<void> create(Restaurant restaurant) async {
    _restaurants.add(restaurant);
    emit();
  }

  @override
  Future<void> update(Restaurant restaurant) async {
    _restaurants.removeWhere((_restaurant) => _restaurant.id == restaurant.id);
    return create(restaurant);
  }

  Stream<List<Restaurant>> stream() {
    return Stream.multi((controller) {
      _listeners.add(controller);

      controller.onCancel = () {
        _listeners.remove(controller);
      };

      emit();
    });
  }

  void emit() {
    for (var listener in _listeners) listener.add(_restaurants);
  }

  static const _fNames = [
    '×“×•×“',
    '××¨×™××œ',
    '×œ×‘×™×',
    '× ×•×¢×',
    '×™×•×¡×£',
    '××•×¨×™',
    '××™×ª×Ÿ',
    '××©×”',
    '×¨×¤××œ',
    '××¨×™',
    '×™×”×•×“×”',
    '××™×ª×™',
    '×“× ×™××œ',
    '××‘×¨×”×',
    '×™×©×¨××œ',
    '×™×”×•× ×ª×Ÿ',
    '×©××•××œ',
    '××œ×™×”',
    '××”×¨×•×Ÿ',
    '×™×¦×—×§',
    '××™×›××œ',
    '×¢×•××¨',
    '×™×¢×§×‘',
    '×™×•× ×ª×Ÿ',
    '×—×™×™×',
    '××™×ª××¨',
    '×©××¢×•×Ÿ',
    '×©×œ××”',
    '×™××™×¨',
    '×¢×™×“×•',
    '×™× ××™',
    '××“×',
    '××œ×•×Ÿ',
    '×‘× ×™×”',
    '××™××¨×™',
    '×”×¨××œ',
    '× ×™×ª××™',
    '×××™×¨',
    '×™×©×™',
    '×ª××¨',
    '×××™×”',
    '× ×•×¢×”',
    '××‘×™×’×™×œ',
    '××™×™×œ×”',
    '×™×¢×œ',
    '×©×¨×”',
    '××“×œ',
    '×©×™×¨×”',
    '××¡×ª×¨',
    '×—× ×”',
    '×¨×‘×§×”',
    '×œ×™×”',
    '×¨×—×œ',
    '×¨×•× ×™',
    '×¨×•××™',
    '××œ×”',
    '×—×™×”',
    '××™×›×œ',
    '×˜×œ×™×”',
    '× ×•×™×”',
    '××¨×™×',
    '×××”',
    '×¢×œ××”',
    '×¨×•×ª',
    '×”×œ×œ',
    '×œ×™×‘×™',
    '×™×•×‘×œ',
    '×”×•×“×™×”',
    '××¨×™××œ',
    '× ×¢××™',
    '××’×',
    '×˜×•×”×¨',
    '×¢×•××¨',
    '×’××™×”',
    '×’×¤×Ÿ',
    '××•×¨×™',
    '×œ×™-×©×™',
    '× ×’×”',
  ];

  static const _lNames = [
    '×›×”×Ÿ',
    '×œ×•×™',
    '××–×¨×—×™',
    '×¤×¨×¥',
    '×‘×™×˜×•×Ÿ',
    '×“×”×Ÿ',
    '××‘×¨×”×',
    '××’×‘××¨×™×”',
    '×¤×¨×™×“××Ÿ',
  ];

  static const _addresses = <String>[
    '××‘×• ×’×•×©',
    '××‘×˜×™×Ÿ',
    '××‘×™××œ',
    '××‘×™×‘×™×',
    '××‘×™×’×“×•×¨',
    '××‘×™×—×™×œ',
    '××‘×™×˜×œ',
    '××‘×™×¢×–×¨',
    '××‘×™×¨×™×',
    '××‘×Ÿ ×™×”×•×“×”',
    '××‘×Ÿ ×× ×—×',
    '××‘×Ÿ ×¡×¤×™×¨',
    '××‘× ×™ ××™×ª×Ÿ',
    '××‘× ×™ ×—×¤×¥',
    '××‘× ×ª',
    '××‘×©×œ×•×',
    '××“×•×¨×”',
    '××“×™×¨×™×',
    '××“××™×ª',
    '××“×¨×ª',
    '××•×’×“×”',
    '××•×“×™×',
    '××•×“×',
    '××•×”×“',
    '××•× ×‘×˜×™×Ÿ',
    '××•×¤×§×™×',
    '××•×¨ ×”×’× ×•×–',
    '××•×¨ ×”× ×¨',
    '××•×¨ ×™×”×•×“×”',
    '××•×¨ ×¢×§×™×‘×',
    '××•×¨×”',
    '××™×™×œ×ª ×”×©×—×¨',
    '××™×œ×•×Ÿ',
    '××™×œ×•×ª',
    '××™×œ× ×™×”',
    '××™×œ×ª',
    '××™×¨×•×¡',
    '××™×ª××¨',
    '××™×ª×Ÿ',
    '××›×¡××œ',
    '××œ ×¢×–×™',
    '××œ-×¢×¨×™××Ÿ',
    '××œ-×¨×•×',
    '××œ×•××”',
    '××œ×•××•×ª',
    '××œ×•×Ÿ ×”×’×œ×™×œ',
    '××œ×•× ×™×',
    '××œ××’×•×¨',
    '××œ××•×’',
    '××œ×¢×“',
    '××œ×¢×–×¨',
    '××¤×™× ×™×©',
    '××¤×™×§',
    '××¤×™×§×™×',
    '××¤×§',
    '××¤×¨×ª',
    '××¨×‘×œ',
    '××¨×’××Ÿ',
    '××¨×–',
    '××¨×™××œ',
    '××¨×¡×•×£',
    '××©×‘×•×œ',
    '××©×‘×œ',
    '××©×“×•×“',
    '××©×“×•×ª ×™×¢×§×‘ ××™×—×•×“',
    '××©×“×•×ª ×™×¢×§×‘ ×××•×—×“',
    '××©×—×¨',
    '××©×›×•×œ×•×ª',
    '××©×œ ×”× ×©×™×',
    '××©×œ×™×',
    '××©×§×œ×•×Ÿ',
    '×‘×™×¨×™×”',
    '×‘×™×ª ××•×¨×Ÿ',
    '×‘×™×ª ××œ',
    '×‘×™×ª ××œ×¢×–×¨×™',
    '×‘×™×ª ××œ×¤×',
    '×‘×™×ª ××¨×™×”-×¢×•×¤×¨×™×',
    '×‘×™×ª ×‘×¨×œ',
    '×‘×™×ª ×’×•×‘×¨×™×Ÿ',
    '×‘×™×ª ×’××œ×™××œ',
    '×‘×™×ª ×“×’×Ÿ',
    '×‘×™×ª ×”×’×“×™',
    '×‘×™×ª ×”×œ×•×™',
    '×‘×™×ª ×”×œ×œ',
    '×‘×™×ª ×”×¢×¨×‘×”',
    '×‘×™×ª ×”×©×™×˜×”',
    '×‘×™×ª ×–×™×™×“',
    '×‘×™×ª ×–×™×ª',
    '×‘×™×ª ×–×¨×¢',
    '×‘×™×ª ×—×’×™',
    '×‘×™×ª ×—×œ×§×™×”',
    '×‘×™×ª ×—× × ×™×”',
    '×‘×™×ª ×—×¨×•×ª',
    '×‘×™×ª ×—×©××•× ××™',
    '×‘×™×ª ×™×”×•×©×¢',
    '×‘×™×ª ×™×•×¡×£',
    '×‘× ×™ ×¦×™×•×Ÿ',
    '×‘× ×™ ×¨××',
    '×‘× ×™×”',
    '×‘×¦×ª',
    '×‘×§×•×¢',
    '×‘×§×¢×•×ª',
    '×‘×¨ ×’×™×•×¨×',
    '×‘×¨ ×™×•×—××™',
    '×‘×¨×•×›×™×Ÿ',
    '×‘×¨×•×¨ ×—×™×œ',
    '×‘×¨×•×©',
    '×‘×¨×›×™×”',
    '×‘×¨×¢×',
    '×‘×¨×§',
    '×‘×¨×§××™',
    '×‘×¨×§×Ÿ',
    '×‘×¨×§×ª',
    '×‘×ª ×”×“×¨',
    '×‘×ª ×—×Ÿ',
    '×’×‘×¢ ×‘× ×™××™×Ÿ',
    '×’×‘×¢ ×›×¨××œ',
    '×’×‘×¢×ª ×–××‘',
    '×’×‘×¢×ª ×—"×Ÿ',
    '×’×‘×¢×ª ×—×‘×™×‘×”',
    '×’×‘×¢×ª ×—×™×™× ××™×—×•×“',
    '×’×–×™×ª',
    '×’×–×¨',
    '×’×™××”',
    '×’×™×–×•',
    '×’×™×œ×•×Ÿ',
    '×’×™×œ×ª',
    '×’×™× ×•×¡×¨',
    '×’×Ÿ ×©××•××œ',
    '×’× ×•×ª',
    '×’× ×™ ×”×“×¨',
    '×’× ×™ ×˜×œ',
    '×’× ×™ ×™×•×—× ×Ÿ',
    '×’× ×™ ××•×“×™×¢×™×Ÿ',
    '×’× ×™ ×¢×',
    '×’× ×™ ×ª×§×•×•×”',
    '×’× ×™×’×¨',
    '×’× ×ª×•×Ÿ',
    '×–××¨',
    '×–××¨×ª',
    '×–× ×•×—',
    '×—×’×•×¨',
    '×—×’×œ×”',
    '×—×“ × ×¡',
    '×—×“×™×“',
    '×—×“×¨×”',
    '×—×•×•×ª ×™××™×¨',
    '×—×•×œ×“×”',
    '×—×•×œ×•×Ÿ',
    '×—×•×œ×™×ª',
    '×—×•×œ×ª×”',
    '×—×•×¡×Ÿ',
    '×—×•×¡× ×™×™×”',
    '×—×•×¤×™×ª',
    '×—×•×§×•×§',
    '×—×•×¨×”',
    '×—×•×¨×¤×™×©',
    '×—×•×¨×©×™×',
    '×—×–×•×Ÿ',
    '×—×™×‘×ª ×¦×™×•×Ÿ',
    '×—×™× × ×™×ª',
    '×—×™×¡×¤×™×Ÿ',
    '×—×™×¤×”',
    '×—×¦×•×¨ ×”×’×œ×™×œ×™×ª',
    '×—×¦×¨×™×',
    '×—×¨×‘ ×œ××ª',
    '×—×¨×•×¦×™×',
    '×—×¨×•×ª',
    '×—×¨×™×©',
    '×—×¨××©',
    '×˜×™×¨×ª ×¦×‘×™',
    '×˜×œ ×©×—×¨',
    '×˜×œ-××œ',
    '×˜×œ×œ×™×',
    '×™×‘×•×œ',
    '×™×‘× ××œ',
    '×™×‘× ×”',
    '×™×’×•×¨',
    '×™×’×œ',
    '×™×“ ×‘× ×™××™×Ÿ',
    '×™×“ ×”×©××•× ×”',
  ];

  String get _randName => '${_fNames[rand.nextInt(_fNames.length)]} '
      '${_lNames[rand.nextInt(_lNames.length)]}';

  String get _randAddress => _addresses[rand.nextInt(_addresses.length)];
}
